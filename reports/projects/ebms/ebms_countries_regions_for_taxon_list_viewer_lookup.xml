<report
    title="EBMS Countries regions For Taxon List Viewer Lookup"
    description="Report that populates the counties and regions in the taxon list viewer."
>
  <query>
    SELECT id, name 
    FROM
    (VALUES 
      (-6, 'Europe'),
      (-5, 'North America'),
      (-4, 'South America'),
      (-3, 'Africa'),
      (-2, 'Asia'),
      (-1, 'Oceania')
    ) as continent(id ,name)
    UNION
    SELECT 
      ttla.id as id,
      coalesce(l.name, ttla.caption) as name
    FROM taxa_taxon_list_attributes ttla
    JOIN taxon_lists_taxa_taxon_list_attributes tlttla 
      ON tlttla.taxa_taxon_list_attribute_id = ttla.id
      AND tlttla.taxon_list_id in (251,260,261,265)
      AND tlttla.deleted=false
    JOIN taxa_taxon_list_attribute_values ttlav on
      ttlav.taxa_taxon_list_attribute_id = ttla.id
      AND ttlav.deleted = false
    LEFT JOIN locations l on l.code = ttla.caption
      AND l.deleted = false and l.location_type_id in (16516,16517)
    WHERE ttla.termlist_id = 816
    AND ttla.deleted = false
  </query>
  <columns>
    <column name='id' datatype="int" />
    <column name='name' datatype="text" />
  </columns>
</report>
<report
    title="EBMS Countries regions For Taxon List Viewer Lookup"
    description="Report that populates the counties and regions in the taxon list viewer."
>
  <query>
    SELECT distinct #columns#
    FROM taxa_taxon_list_attributes ttla
    JOIN taxon_lists_taxa_taxon_list_attributes tlttla 
      ON tlttla.taxa_taxon_list_attribute_id = ttla.id
      AND tlttla.taxon_list_id in (251,260,261,265)
      AND tlttla.deleted=false
    JOIN taxa_taxon_list_attribute_values ttlav on
      ttlav.taxa_taxon_list_attribute_id = ttla.id
      AND ttlav.deleted = false
    LEFT JOIN locations l on l.code = ttla.caption
      AND l.deleted = false and l.location_type_id in (16516,16517)
    WHERE ttla.termlist_id = 816
    AND ttla.deleted = false
  </query>
  <columns>
    <column name='ttla_id' display='Taxa taxon list attribute ID' sql='ttla.id' datatype="int" />
    <column name='loc_name' display='Location name' sql='coalesce(l.name, ttla.caption)' datatype="text" />
  </columns>
</report>